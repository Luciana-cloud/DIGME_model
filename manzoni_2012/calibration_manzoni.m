function [SSE] = calibration_manzoni(p)

% Calling data

data        = load("data_manzoni_matlab.txt");
%% 
% x           = data(1:17,3); % Ayora.ES - Ambient
% x           = data(18:34,3); % Ayora.ES - Drought
% x           = data(35:58,3); % GIG - Ambient
% x           = data(59:82,3); % GIG - Drought
% x           = data(83:106,3); % P12 - Ambient
% x           = data(107:130,3); % P12 - Drought
% x           = data(131:154,3); % P13 - Ambient
x           = cat(1,data(155:161,3),data(163:178,3)); % P13 - Drought
% x           = data(179:196,3); % PNE_unburned - Ambient
% x           = data(197:214,3); % PNE_unburned - Drought
% x           = data(215:238,3); % Purdue.us - Ambient
% x           = data(239:262,3); % Purdue.us - Drought
% x           = data(263:292,3); % Sev.mix - Ambient
% x           = data(293:322,3); % Sev.mix - Drought
% x           = data(323:352,3); % baddrt.de - Ambient
% x           = data(353:381,3); % baddrt.de - Drought
% x           = data(382:399,3); % brhill.au - Ambient
% x           = data(400:417,3); % brhill.au - Drought
% x           = data(418:433,3); % brookdale.ca - Ambient
% x           = data(434:450,3); % brookdale.ca - Drought
% x           = data(451:476,3); % cedarsav.us - Ambient
% x           = data(477:501,3); % cedarsav.us - Drought
% x           = data(502:518,3); % cobar.au - Ambient
% x           = data(519:535,3); % cobar.au - Drought
% x           = data(536:550,3); % cowidrt.ca - Ambient
% x           = data(551:566,3); % cowidrt.ca - Drought
% x           = data(567:589,3); % dona.ana - Ambient
% x           = data(590:613,3); % dona.ana - Drought
% x           = data(614:630,3); % hoide.de - Ambient
% x           = data(631:646,3); % hoide.de - Drought
% x           = data(647:670,3); % horacg,cr - Ambient
% x           = data(671:694,3); % horacg,cr - Drought
% x           = data(695:708,3); % hyide.de - Ambient
% x           = data(709:721,3); % hyide.de - Drought
% x           = data(722:739,3); % lygra.no - Ambient
% x           = data(740:756,3); % lygra.no - Drought
% x           = data(757:774,3); % nyngan.au - Ambient
% x           = data(775:792,3); % nyngan.au - Drought
% x           = data(793:816,3); % passogavia.it - Ambient
% x           = data(817:840,3); % passogavia.it - Drought
% x           = data(841:852,3); % riomayo.ar - Ambient
% x           = data(853:866,3); % riomayo.ar - Drought
% x           = data(867:896,3); % scruzl.us - Ambient
% x           = data(897:926,3); % scruzl.us - Drought
% x           = data(927:949,3); % sgsdrt.us - Ambient
% x           = data(950:973,3); % sgsdrt.us - Drought
% x           = data(974:990,3); % skotsvar.no - Ambient
% x           = data(991:1008,3); % skotsvar.no - Drought
% x           = data(1009:1026,3); % ukulingadrt.za - Ambient
% x           = data(1027:1044,3); % ukulingadrt.za - Drought
% x           = data(1045:1062,3); % wayqe.re - Ambient
% x           = data(1063:1080,3); % wayqe.re - Drought

%%
% Calling model
SR_sim      = manzoni_model(x,p);
% max_f       = max(data(1:17,4)); % Ayora.ES - Ambient - maximum respiration
% max_f       = max(data(18:34,4)); % Ayora.ES - Drought - maximum respiration
% max_f       = max(data(35:58,4)); % GIG - Ambient - maximum respiration
% max_f       = max(data(59:82,4)); % GIG - Drought - maximum respiration
% max_f       = max(data(83:106,4)); % P12 - Ambient - maximum respiration
% max_f       = max(data(107:130,4)); % P12 - Drought - maximum respiration
% max_f       = max(data(131:154,4)); % P13 - Ambient - maximum respiration
max_f       = max(cat(1,data(155:161,4),data(163:178,4))); % P13 - Drought - maximum respiration
% max_f       = max(data(179:196,4)); % PNE_unburned - Ambient - maximum respiration
% max_f       = max(data(197:214,4)); % PNE_unburned - Drought - maximum respiration
% max_f       = max(data(215:238,4)); % Purdue.us - Ambient - maximum respiration
% max_f       = max(data(239:262,4)); % Purdue.us - Drought - maximum respiration
% max_f       = max(data(263:292,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(293:322,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(323:352,4)); % baddrt.de - Ambient - maximum respiration
% max_f       = max(data(353:381,4)); % baddrt.de - Drought - maximum respiration
% max_f       = max(data(382:399,4)); % brhill.au - Ambient - maximum respiration
% max_f       = max(data(400:417,4)); % brhill.au - Drought - maximum respiration
% max_f       = max(data(418:433,4)); % brookdale.ca - Ambient - maximum respiration
% max_f       = max(data(434:450,4)); % brookdale.ca - Drought - maximum respiration
% max_f       = max(data(451:476,4)); % cedarsav.us - Ambient - maximum respiration
% max_f       = max(data(477:501,4)); % cedarsav.us - Drought - maximum respiration
% max_f       = max(data(502:518,4)); % cobar.au - Ambient - maximum respiration
% max_f       = max(data(519:535,4)); % cobar.au - Drought - maximum respiration
% max_f       = max(data(536:550,4)); % cowidrt.ca - Ambient - maximum respiration
% max_f       = max(data(551:566,4)); % cowidrt.ca - Drought - maximum respiration
% max_f       = max(data(567:589,4)); % dona.ana - Ambient - maximum respiration
% max_f       = max(data(590:613,4)); % dona.ana - Drought - maximum respiration
% max_f       = max(data(614:630,4)); % hoide.de - Ambient - maximum respiration
% max_f       = max(data(631:646,4)); % hoide.de - Drought - maximum respiration
% max_f       = max(data(647:670,4)); % horacg,cr - Ambient - maximum respiration
% max_f       = max(data(671:694,4)); % horacg,cr - Drought - maximum respiration
% max_f       = max(data(695:708,4)); % hyide.de - Ambient - maximum respiration
% max_f       = max(data(709:721,4)); % hyide.de - Drought - maximum respiration
% max_f       = max(data(722:739,4)); % lygra.no - Ambient - maximum respiration
% max_f       = max(data(740:756,4)); % lygra.no - Drought - maximum respiration
% max_f       = max(data(757:774,4)); % nyngan.au - Ambient - maximum respiration
% max_f       = max(data(775:792,4)); % nyngan.au - Drought - maximum respiration
% max_f       = max(data(793:816,4)); % passogavia.it - Ambient - maximum respiration
% max_f       = max(data(817:840,4)); % passogavia.it - Drought - maximum respiration
% max_f       = max(data(841:852,4)); % riomayo.ar - Ambient - maximum respiration
% max_f       = max(data(853:866,4)); % riomayo.ar - Drought - maximum respiration
% max_f       = max(data(867:896,4)); % scruzl.us - Ambient - maximum respiration
% max_f       = max(data(897:926,4)); % scruzl.us - Drought - maximum respiration
% max_f       = max(data(927:949,4)); % sgsdrt.us - Ambient - maximum respiration
% max_f       = max(data(950:973,4)); % sgsdrt.us - Drought - maximum respiration
% max_f       = max(data(974:990,4)); % skotsvar.no - Ambient - maximum respiration
% max_f       = max(data(991:1008,4)); % skotsvar.no - Drought - maximum respiration
% max_f       = max(data(1009:1026,4)); % ukulingadrt.za - Ambient - maximum respiration
% max_f       = max(data(1027:1044,4)); % ukulingadrt.za - Drought - maximum respiration
% max_f       = max(data(1045:1062,4)); % wayqe.re - Ambient - maximum respiration
% max_f       = max(data(1063:1080,4)); % wayqe.re - Drought - maximum respiration

% Observations
% SR_obs      = data(1:17,4)/max_f; % Ayora.ES - Ambient
% SR_obs      = data(18:34,4)/max_f; % Ayora.ES - Drought
% SR_obs      = data(35:58,4)/max_f; % GIG - Ambient
% SR_obs      = data(59:82,4)/max_f; % GIG - Drought
% SR_obs      = data(83:106,4)/max_f; % P12 - Ambient
% SR_obs      = data(107:130,4)/max_f; % P12 - Drought
% SR_obs      = data(131:154,4)/max_f; % P13 - Ambient
SR_obs      = cat(1,data(155:161,4),data(163:178,4))/max_f; % P13 - Drought
% SR_obs      = data(179:196,4)/max_f; % PNE_unburned - Ambient
% SR_obs      = data(197:214,4)/max_f; % PNE_unburned - Drought
% SR_obs      = data(215:238,4)/max_f; % Purdue.us - Ambient
% SR_obs      = data(239:262,4)/max_f; % Purdue.us - Drought
% SR_obs      = data(263:292,4)/max_f; % Sev.mix - Ambient
% SR_obs      = data(293:322,4)/max_f; % Sev.mix - Drought
% SR_obs      = data(323:352,4)/max_f; % baddrt.de - Ambient
% SR_obs      = data(353:381,4)/max_f; % baddrt.de - Drought
% SR_obs      = data(382:399,4)/max_f; % brhill.au - Ambient
% SR_obs      = data(400:417,4)/max_f; % brhill.au - Drought
% SR_obs      = data(418:433,4)/max_f; % brookdale.ca - Ambient
% SR_obs      = data(434:450,4)/max_f; % brookdale.ca - Drought
% SR_obs      = data(451:476,4)/max_f; % cedarsav.us - Ambient
% SR_obs      = data(477:501,4)/max_f; % cedarsav.us - Drought
% SR_obs      = data(502:518,4)/max_f; % cobar.au - Ambient
% SR_obs      = data(519:535,4)/max_f; % cobar.au - Drought
% SR_obs      = data(536:550,4)/max_f; % cowidrt.ca - Ambient
% SR_obs      = data(551:566,4)/max_f; % cowidrt.ca - Drought
% SR_obs      = data(567:589,4)/max_f; % dona.ana - Ambient
% SR_obs      = data(590:613,4)/max_f; % dona.ana - Drought
% SR_obs      = data(614:630,4)/max_f; % hoide.de - Ambient
% SR_obs      = data(631:646,4)/max_f; % hoide.de - Drought
% SR_obs      = data(647:670,4)/max_f; % horacg,cr - Ambient
% SR_obs      = data(671:694,4)/max_f; % horacg,cr - Drought
% SR_obs      = data(695:708,4)/max_f; % hyide.de - Ambient
% SR_obs      = data(709:721,4)/max_f; % hyide.de - Drought
% SR_obs      = data(722:739,4)/max_f; % lygra.no - Ambient
% SR_obs      = data(740:756,4)/max_f; % lygra.no - Drought
% SR_obs      = data(757:774,4)/max_f; % nyngan.au - Ambient
% SR_obs      = data(775:792,4)/max_f; % nyngan.au - Drought
% SR_obs      = data(793:816,4)/max_f; % passogavia.it - Ambient
% SR_obs      = data(817:840,4)/max_f; % passogavia.it - Drought
% SR_obs      = data(841:852,4)/max_f; % riomayo.ar - Ambient
% SR_obs      = data(853:866,4)/max_f; % riomayo.ar - Drought
% SR_obs      = data(867:896,4)/max_f; % scruzl.us - Ambient
% SR_obs      = data(897:926,4)/max_f; % scruzl.us - Drought
% SR_obs      = data(927:949,4)/max_f; % sgsdrt.us - Ambient
% SR_obs      = data(950:973,4)/max_f; % sgsdrt.us - Drought
% SR_obs      = data(974:990,4)/max_f; % skotsvar.no - Ambient
% SR_obs      = data(991:1008,4)/max_f; % skotsvar.no - Drought
% SR_obs      = data(1009:1026,4)/max_f; % ukulingadrt.za - Ambient
% SR_obs      = data(1027:1044,4)/max_f; % ukulingadrt.za - Drought
% SR_obs      = data(1045:1062,4)/max_f; % wayqe.re - Ambient
% SR_obs      = data(1063:1080,4)/max_f; % wayqe.re - Drought

% Standard deviations
% SR_sd      = data(1:17,5)/max_f; % Ayora.ES - Ambient
% SR_sd      = data(18:34,5)/max_f; % Ayora.ES - Drought
% SR_sd      = data(35:58,5)/max_f; % GIG - Ambient
% SR_sd      = data(59:82,5)/max_f; % GIG - Drought
% SR_sd      = data(83:106,5)/max_f; % P12 - Ambient
% SR_sd      = data(107:130,5)/max_f; % P12 - Drought
% SR_sd      = data(131:154,5)/max_f; % P13 - Ambient
SR_sd      = cat(1,data(155:161,5),data(163:178,5))/max_f; % P13 - Drought
% SR_sd      = data(179:196,5)/max_f; % PNE_unburned - Ambient
% SR_sd      = data(197:214,5)/max_f; % PNE_unburned - Drought
% SR_sd      = data(215:238,5)/max_f; % Purdue.us - Ambient
% SR_sd      = data(239:262,5)/max_f; % Purdue.us - Drought
% SR_sd      = data(263:292,5)/max_f; % Sev.mix - Ambient
% SR_sd      = data(293:322,5)/max_f; % Sev.mix - Drought
% SR_sd      = data(323:352,5)/max_f; % baddrt.de - Ambient
% SR_sd      = data(353:381,5)/max_f; % baddrt.de - Drought
% SR_sd      = data(382:399,5)/max_f; % brhill.au - Ambient
% SR_sd      = data(400:417,5)/max_f; % brhill.au - Drought
% SR_sd      = data(418:433,5)/max_f; % brookdale.ca - Ambient
% SR_sd      = data(434:450,5)/max_f; % brookdale.ca - Drought
% SR_sd      = data(451:476,5)/max_f; % cedarsav.us - Ambient
% SR_sd      = data(477:501,5)/max_f; % cedarsav.us - Drought
% SR_sd      = data(502:518,5)/max_f; % cobar.au - Ambient
% SR_sd      = data(519:535,5)/max_f; % cobar.au - Drought
% SR_sd      = data(536:550,5)/max_f; % cowidrt.ca - Ambient
% SR_sd      = data(551:566,5)/max_f; % cowidrt.ca - Drought
% SR_sd      = data(567:589,5)/max_f; % dona.ana - Ambient
% SR_sd      = data(590:613,5)/max_f; % dona.ana - Drought
% SR_sd      = data(614:630,5)/max_f; % hoide.de - Ambient
% SR_sd      = data(631:646,5)/max_f; % hoide.de - Drought
% SR_sd      = data(647:670,5)/max_f; % horacg,cr - Ambient
% SR_sd      = data(671:694,5)/max_f; % horacg,cr - Drought
% SR_sd      = data(695:708,5)/max_f; % hyide.de - Ambient
% SR_sd      = data(709:721,5)/max_f; % hyide.de - Drought
% SR_sd      = data(722:739,5)/max_f; % lygra.no - Ambient
% SR_sd      = data(740:756,5)/max_f; % lygra.no - Drought
% SR_sd      = data(757:774,5)/max_f; % nyngan.au - Ambient
% SR_sd      = data(775:792,5)/max_f; % nyngan.au - Drought
% SR_sd      = data(793:816,5)/max_f; % passogavia.it - Ambient
% SR_sd      = data(817:840,5)/max_f; % passogavia.it - Drought
% SR_sd      = data(841:852,5)/max_f; % riomayo.ar - Ambient
% SR_sd      = data(853:866,5)/max_f; % riomayo.ar - Drought
% SR_sd      = data(867:896,5)/max_f; % scruzl.us - Ambient
% SR_sd      = data(897:926,5)/max_f; % scruzl.us - Drought
% SR_sd      = data(927:949,5)/max_f; % sgsdrt.us - Ambient
% SR_sd      = data(950:973,5)/max_f; % sgsdrt.us - Drought
% SR_sd      = data(974:990,5)/max_f; % skotsvar.no - Ambient
% SR_sd      = data(991:1008,5)/max_f; % skotsvar.no - Drought
% SR_sd      = data(1009:1026,5)/max_f; % ukulingadrt.za - Ambient
% SR_sd      = data(1027:1044,5)/max_f; % ukulingadrt.za - Drought
% SR_sd      = data(1045:1062,5)/max_f; % wayqe.re - Ambient
% SR_sd      = data(1063:1080,5)/max_f; % wayqe.re - Drought

% Objective function - residual sum of squares
SSE_1       = sum(((log(SR_obs) - log(SR_sim)).^2)./(log(SR_sd)).^2);
% SSE         = SSE_1^0.5
SSE         = SSE_1

% fig = figure;
plot(log10(x),SR_sim,"*");
hold on
plot(log10(x),SR_obs,"o");
xline(log10(p(3)),'-r');
xline(p(1),'-b');

% fig = figure;
% scatter(SR_obs,SR_sim)
end