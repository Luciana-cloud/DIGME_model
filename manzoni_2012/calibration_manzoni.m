function [SSE] = calibration_manzoni(p)

% Calling data
% 
data        = load("data_manzoni_matlab.txt");
%% 
% x           = data(1:18,3); % Ayora.ES - Ambient
x           = data(19:36,3); % Ayora.ES - Drought
% x           = data(37:60,3); % GIG - Ambient
% x           = data(61:84,3); % GIG - Drought
% x           = data(85:108,3); % P12 - Ambient
% x           = data(109:132,3); % P12 - Drought
% x           = data(133:156,3); % P13 - Ambient
% x           = cat(1,data(157:163,3),data(165:180,3)); % P13 - Drought
% x           = data(181:198,3); % PNE_unburned - Ambient***
% x           = data(199:216,3); % PNE_unburned - Drought
% x           = data(217:240,3); % Purdue.us - Ambient
% x           = data(241:264,3); % Purdue.us - Drought
% x           = data(265:294,3); % Sev.mix - Ambient
% x           = data(295:324,3); % Sev.mix - Drought
% x           = data(325:354,3); % baddrt.de - Ambient
% x           = data(355:383,3); % baddrt.de - Drought
% x           = data(384:401,3); % brhill.au - Ambient
% x           = data(402:419,3); % brhill.au - Drought
% x           = data(420:437,3); % brookdale.ca - Ambient
% x           = data(438:455,3); % brookdale.ca - Drought
% x           = data(456:481,3); % cedarsav.us - Ambient
% x           = data(482:507,3); % cedarsav.us - Drought
% x           = data(508:524,3); % cobar.au - Ambient
% x           = data(525:541,3); % cobar.au - Drought
% x           = data(542:565,3); % cowidrt.ca - Ambient
% x           = data(566:589,3); % cowidrt.ca - Drought
% x           = data(590:612,3); % dona.ana - Ambient
% x           = data(613:636,3); % dona.ana - Drought
% x           = data(637:654,3); % hoide.de - Ambient
% x           = data(655:672,3); % hoide.de - Drought
% x           = data(673:696,3); % horacg,cr - Ambient
% x           = data(697:720,3); % horacg,cr - Drought
% x           = data(721:737,3); % hyide.de - Ambient
% x           = data(738:753,3); % hyide.de - Drought
% x           = data(754:771,3); % lygra.no - Ambient
% x           = data(772:789,3); % lygra.no - Drought
% x           = data(790:807,3); % nyngan.au - Ambient
% x           = data(808:825,3); % nyngan.au - Drought
% x           = data(826:849,3); % passogavia.it - Ambient
% x           = data(850:873,3); % passogavia.it - Drought
% x           = data(874:888,3); % riomayo.ar - Ambient
% x           = data(889:905,3); % riomayo.ar - Drought
% x           = data(906:935,3); % scruzl.us - Ambient
% x           = data(936:965,3); % scruzl.us - Drought
% x           = data(966:988,3); % sgsdrt.us - Ambient
% x           = data(989:1012,3); % sgsdrt.us - Drought
% x           = data(1013:1030,3); % skotsvar.no - Ambient
% x           = data(1031:1048,3); % skotsvar.no - Drought
% x           = data(1049:1066,3); % ukulingadrt.za - Ambient
% x           = data(1067:1084,3); % ukulingadrt.za - Drought
% x           = data(1085:1102,3); % wayqe.re - Ambient
% x           = data(1103:1120,3); % wayqe.re - Drought

%%
% Calling model
SR_sim      = manzoni_model(x,p);
% max_f       = max(data(1:18,4)); % Ayora.ES - Ambient - maximum respiration
max_f       = max(data(19:36,4)); % Ayora.ES - Drought - maximum respiration
% max_f       = max(data(37:60,4)); % GIG - Ambient - maximum respiration
% max_f       = max(data(61:84,4)); % GIG - Drought - maximum respiration
% max_f       = max(data(85:108,4)); % P12 - Ambient - maximum respiration
% max_f       = max(data(109:132,4)); % P12 - Drought - maximum respiration
% max_f       = max(data(133:156,4)); % P13 - Ambient - maximum respiration
% max_f       = max(cat(1,data(157:163,4),data(165:180,4))); % P13 - Drought - maximum respiration
% max_f       = max(data(181:198,4)); % PNE_unburned - Ambient - maximum respiration
% max_f       = max(data(199:216,4)); % PNE_unburned - Drought - maximum respiration
% max_f       = max(data(217:240,4)); % Purdue.us - Ambient - maximum respiration
% max_f       = max(data(241:264,4)); % Purdue.us - Drought - maximum respiration
% max_f       = max(data(265:294,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(295:324,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(325:354,4)); % baddrt.de - Ambient - maximum respiration
% max_f       = max(data(355:383,4)); % baddrt.de - Drought - maximum respiration
% max_f       = max(data(384:401,4)); % brhill.au - Ambient - maximum respiration
% max_f       = max(data(402:419,4)); % brhill.au - Drought - maximum respiration
% max_f       = max(data(420:437,4)); % brookdale.ca - Ambient - maximum respiration
% max_f       = max(data(438:455,4)); % brookdale.ca - Drought - maximum respiration
% max_f       = max(data(456:481,4)); % cedarsav.us - Ambient - maximum respiration
% max_f       = max(data(482:507,4)); % cedarsav.us - Drought - maximum respiration
% max_f       = max(data(508:524,4)); % cobar.au - Ambient - maximum respiration
% max_f       = max(data(525:541,4)); % cobar.au - Drought - maximum respiration
% max_f       = max(data(542:565,4)); % cowidrt.ca - Ambient - maximum respiration
% max_f       = max(data(566:589,4)); % cowidrt.ca - Drought - maximum respiration
% max_f       = max(data(590:612,4)); % dona.ana - Ambient - maximum respiration
% max_f       = max(data(613:636,4)); % dona.ana - Drought - maximum respiration
% max_f       = max(data(637:654,4)); % hoide.de - Ambient - maximum respiration
% max_f       = max(data(655:672,4)); % hoide.de - Drought - maximum respiration
% max_f       = max(data(673:696,4)); % horacg,cr - Ambient - maximum respiration
% max_f       = max(data(697:720,4)); % horacg,cr - Drought - maximum respiration
% max_f       = max(data(721:737,4)); % hyide.de - Ambient - maximum respiration
% max_f       = max(data(738:753,4)); % hyide.de - Drought - maximum respiration
% max_f       = max(data(754:771,4)); % lygra.no - Ambient - maximum respiration
% max_f       = max(data(772:789,4)); % lygra.no - Drought - maximum respiration
% max_f       = max(data(790:807,4)); % nyngan.au - Ambient - maximum respiration
% max_f       = max(data(808:825,4)); % nyngan.au - Drought - maximum respiration
% max_f       = max(data(826:849,4)); % passogavia.it - Ambient - maximum respiration
% max_f       = max(data(850:873,4)); % passogavia.it - Drought - maximum respiration
% max_f       = max(data(874:888,4)); % riomayo.ar - Ambient - maximum respiration
% max_f       = max(data(889:905,4)); % riomayo.ar - Drought - maximum respiration
% max_f       = max(data(906:935,4)); % scruzl.us - Ambient - maximum respiration
% max_f       = max(data(936:965,4)); % scruzl.us - Drought - maximum respiration
% max_f       = max(data(966:988,4)); % sgsdrt.us - Ambient - maximum respiration
% max_f       = max(data(989:1012,4)); % sgsdrt.us - Drought - maximum respiration
% max_f       = max(data(1013:1030,4)); % skotsvar.no - Ambient - maximum respiration
% max_f       = max(data(1031:1048,4)); % skotsvar.no - Drought - maximum respiration
% max_f       = max(data(1049:1066,4)); % ukulingadrt.za - Ambient - maximum respiration
% max_f       = max(data(1067:1084,4)); % ukulingadrt.za - Drought - maximum respiration
% max_f       = max(data(1085:1102,4)); % wayqe.re - Ambient - maximum respiration
% max_f       = max(data(1103:1120,4)); % wayqe.re - Drought - maximum respiration

% Observations
% SR_obs      = data(1:18,4)/max_f; % Ayora.ES - Ambient
SR_obs      = data(19:36,4)/max_f; % Ayora.ES - Drought
% SR_obs      = data(37:60,4)/max_f; % GIG - Ambient
% SR_obs      = data(61:84,4)/max_f; % GIG - Drought
% SR_obs      = data(85:108,4)/max_f; % P12 - Ambient
% SR_obs      = data(109:132,4)/max_f; % P12 - Drought
% SR_obs      = data(133:156,4)/max_f; % P13 - Ambient
% SR_obs      = cat(1,data(157:163,4),data(165:180,4))/max_f; % P13 - Drought
% SR_obs      = data(181:198,4)/max_f; % PNE_unburned - Ambient
% SR_obs      = data(199:216,4)/max_f; % PNE_unburned - Drought
% SR_obs      = data(217:240,4)/max_f; % Purdue.us - Ambient
% SR_obs      = data(241:264,4)/max_f; % Purdue.us - Drought
% SR_obs      = data(265:294,4)/max_f; % Sev.mix - Ambient
% SR_obs      = data(295:324,4)/max_f; % Sev.mix - Drought
% SR_obs      = data(325:354,4)/max_f; % baddrt.de - Ambient
% SR_obs      = data(355:383,4)/max_f; % baddrt.de - Drought
% SR_obs      = data(384:401,4)/max_f; % brhill.au - Ambient
% SR_obs      = data(402:419,4)/max_f; % brhill.au - Drought
% SR_obs      = data(420:437,4)/max_f; % brookdale.ca - Ambient
% SR_obs      = data(438:455,4)/max_f; % brookdale.ca - Drought
% SR_obs      = data(456:481,4)/max_f; % cedarsav.us - Ambient
% SR_obs      = data(482:507,4)/max_f; % cedarsav.us - Drought
% SR_obs      = data(508:524,4)/max_f; % cobar.au - Ambient
% SR_obs      = data(525:541,4)/max_f; % cobar.au - Drought
% SR_obs      = data(542:565,4)/max_f; % cowidrt.ca - Ambient
% SR_obs      = data(566:589,4)/max_f; % cowidrt.ca - Drought
% SR_obs      = data(590:612,4)/max_f; % dona.ana - Ambient
% SR_obs      = data(613:636,4)/max_f; % dona.ana - Drought
% SR_obs      = data(637:654,4)/max_f; % hoide.de - Ambient
% SR_obs      = data(655:672,4)/max_f; % hoide.de - Drought
% SR_obs      = data(673:696,4)/max_f; % horacg,cr - Ambient
% SR_obs      = data(697:720,4)/max_f; % horacg,cr - Drought
% SR_obs      = data(721:737,4)/max_f; % hyide.de - Ambient
% SR_obs      = data(738:753,4)/max_f; % hyide.de - Drought
% SR_obs      = data(754:771,4)/max_f; % lygra.no - Ambient
% SR_obs      = data(772:789,4)/max_f; % lygra.no - Drought
% SR_obs      = data(790:807,4)/max_f; % nyngan.au - Ambient
% SR_obs      = data(808:825,4)/max_f; % nyngan.au - Drought
% SR_obs      = data(826:849,4)/max_f; % passogavia.it - Ambient
% SR_obs      = data(850:873,4)/max_f; % passogavia.it - Drought
% SR_obs      = data(874:888,4)/max_f; % riomayo.ar - Ambient
% SR_obs      = data(889:905,4)/max_f; % riomayo.ar - Drought
% SR_obs      = data(906:935,4)/max_f; % scruzl.us - Ambient
% SR_obs      = data(936:965,4)/max_f; % scruzl.us - Drought
% SR_obs      = data(966:988,4)/max_f; % sgsdrt.us - Ambient
% SR_obs      = data(989:1012,4)/max_f; % sgsdrt.us - Drought
% SR_obs      = data(1013:1030,4)/max_f; % skotsvar.no - Ambient
% SR_obs      = data(1031:1048,4)/max_f; % skotsvar.no - Drought
% SR_obs      = data(1049:1066,4)/max_f; % ukulingadrt.za - Ambient
% SR_obs      = data(1067:1084,4)/max_f; % ukulingadrt.za - Drought
% SR_obs      = data(1085:1102,4)/max_f; % wayqe.re - Ambient
% SR_obs      = data(1103:1120,4)/max_f; % wayqe.re - Drought

% Standard deviations
% SR_sd      = data(1:18,5)/max_f; % Ayora.ES - Ambient
SR_sd      = data(19:36,5)/max_f; % Ayora.ES - Drought
% SR_sd      = data(37:60,5)/max_f; % GIG - Ambient
% SR_sd      = data(61:84,5)/max_f; % GIG - Drought
% SR_sd      = data(85:108,5)/max_f; % P12 - Ambient
% SR_sd      = data(109:132,5)/max_f; % P12 - Drought
% SR_sd      = data(133:156,5)/max_f; % P13 - Ambient
% SR_sd      = cat(1,data(157:163,5),data(165:180,5))/max_f; % P13 - Drought
% SR_sd      = data(181:198,5)/max_f; % PNE_unburned - Ambient
% SR_sd      = data(199:216,5)/max_f; % PNE_unburned - Drought
% SR_sd      = data(217:240,5)/max_f; % Purdue.us - Ambient
% SR_sd      = data(241:264,5)/max_f; % Purdue.us - Drought
% SR_sd      = data(265:294,5)/max_f; % Sev.mix - Ambient
% SR_sd      = data(295:324,5)/max_f; % Sev.mix - Drought
% SR_sd      = data(325:354,5)/max_f; % baddrt.de - Ambient
% SR_sd      = data(355:383,5)/max_f; % baddrt.de - Drought
% SR_sd      = data(384:401,5)/max_f; % brhill.au - Ambient
% SR_sd      = data(402:419,5)/max_f; % brhill.au - Drought
% SR_sd      = data(420:437,5)/max_f; % brookdale.ca - Ambient
% SR_sd      = data(438:455,5)/max_f; % brookdale.ca - Drought
% SR_sd      = data(456:481,5)/max_f; % cedarsav.us - Ambient
% SR_sd      = data(482:507,5)/max_f; % cedarsav.us - Drought
% SR_sd      = data(508:524,5)/max_f; % cobar.au - Ambient
% SR_sd      = data(525:541,5)/max_f; % cobar.au - Drought
% SR_sd      = data(542:565,5)/max_f; % cowidrt.ca - Ambient
% SR_sd      = data(566:589,5)/max_f; % cowidrt.ca - Drought
% SR_sd      = data(590:612,5)/max_f; % dona.ana - Ambient
% SR_sd      = data(613:636,5)/max_f; % dona.ana - Drought
% SR_sd      = data(637:654,5)/max_f; % hoide.de - Ambient
% SR_sd      = data(655:672,5)/max_f; % hoide.de - Drought
% SR_sd      = data(673:696,5)/max_f; % horacg,cr - Ambient
% SR_sd      = data(697:720,5)/max_f; % horacg,cr - Drought
% SR_sd      = data(721:737,5)/max_f; % hyide.de - Ambient
% SR_sd      = data(738:753,5)/max_f; % hyide.de - Drought
% SR_sd      = data(754:771,5)/max_f; % lygra.no - Ambient
% SR_sd      = data(772:789,5)/max_f; % lygra.no - Drought
% SR_sd      = data(790:807,5)/max_f; % nyngan.au - Ambient
% SR_sd      = data(808:825,5)/max_f; % nyngan.au - Drought
% SR_sd      = data(826:849,5)/max_f; % passogavia.it - Ambient
% SR_sd      = data(850:873,5)/max_f; % passogavia.it - Drought
% SR_sd      = data(874:888,5)/max_f; % riomayo.ar - Ambient
% SR_sd      = data(889:905,5)/max_f; % riomayo.ar - Drought
% SR_sd      = data(906:935,5)/max_f; % scruzl.us - Ambient
% SR_sd      = data(936:965,5)/max_f; % scruzl.us - Drought
% SR_sd      = data(966:988,5)/max_f; % sgsdrt.us - Ambient
% SR_sd      = data(989:1012,5)/max_f; % sgsdrt.us - Drought
% SR_sd      = data(1013:1030,5)/max_f; % skotsvar.no - Ambient
% SR_sd      = data(1031:1048,5)/max_f; % skotsvar.no - Drought
% SR_sd      = data(1049:1066,5)/max_f; % ukulingadrt.za - Ambient
% SR_sd      = data(1067:1084,5)/max_f; % ukulingadrt.za - Drought
% SR_sd      = data(1085:1102,5)/max_f; % wayqe.re - Ambient
% SR_sd      = data(1103:1120,5)/max_f; % wayqe.re - Drought

% Objective function - residual sum of squares
SSE_1       = sum(((log(SR_obs) - log(SR_sim)).^2)./(log(SR_sd)).^2);
% SSE         = SSE_1^0.5
SSE         = SSE_1

% fig = figure;
plot(log10(x),SR_sim,"*");
hold on
plot(log10(x),SR_obs,"o");
xline(log10(p(3)),'-r');
xline(p(1),'-b');

% fig = figure;
% scatter(SR_obs,SR_sim)
end