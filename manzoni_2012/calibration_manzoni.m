function [SSE] = calibration_manzoni(p)

% Calling data
% 
data        = load("manzoni_new_matlab.txt");

%% Soil Water Potential

% x           = data(1:18,3); % Ayora.ES - Ambient
% x           = data(19:36,3); % Ayora.ES - Drought
% x           = data(37:66,3); % baddrt.de - Ambient
% x           = data(67:95,3); % baddrt.de - Drought
% x           = data(96:113,3); % brhill.au - Ambient
% x           = data(114:131,3); % brhill.au - Drought
% x           = data(132:149,3); % brookdale.ca - Ambient
% x           = data(150:167,3); % brookdale.ca - Drought
% x           = data(168:197,3); % cedarsav.us - Ambient
% x           = data(198:227,3); % cedarsav.us - Drought
% x           = data(228:245,3); % cobar.au - Ambient
% x           = data(246:263,3); % cobar.au - Drought
% x           = data(264:287,3); % cowidrt.ca - Ambient
% x           = data(288:311,3); % cowidrt.ca - Drought
% x           = data(312:335,3); % dona.ana - Ambient
% x           = data(336:359,3); % dona.ana - Drought
% x           = data(360:383,3); % GIG - Ambient
% x           = data(384:407,3); % GIG - Drought
% x           = data(408:425,3); % hoide.de - Ambient
% x           = data(426:443,3); % hoide.de - Drought
% x           = data(444:467,3); % horacg,cr - Ambient
% x           = data(468:491,3); % horacg,cr - Drought
% x           = data(492:509,3); % hyide.de - Ambient
% x           = data(510:527,3); % hyide.de - Drought
% x           = data(528:545,3); % lygra.no - Ambient
% x           = data(546:563,3); % lygra.no - Drought
% x           = data(564:581,3); % nyngan.au - Ambient
% x           = data(582:599,3); % nyngan.au - Drought
% x           = data(600:623,3); % P12 - Ambient
% x           = data(624:647,3); % P12 - Drought
% x           = data(648:671,3); % P13 - Ambient
% x           = data(672:695,3); % P13 - Drought
% x           = data(696:719,3); % passogavia.it - Ambient
% x           = data(720:743,3); % passogavia.it - Drought
% x           = data(744:761,3); % PNE_unburned - Ambient
% x           = data(762:779,3); % PNE_unburned - Drought
% x           = data(780:803,3); % Purdue.us - Ambient
% x           = data(804:827,3); % Purdue.us - Drought
% x           = data(828:842,3); % riomayo.ar - Ambient
% x           = data(843:859,3); % riomayo.ar - Drought
% x           = data(860:889,3); % scruzl.us - Ambient
% x           = data(890:919,3); % scruzl.us - Drought
% x           = data(920:949,3); % Sev.mix - Ambient
% x           = data(950:979,3); % Sev.mix - Drought
% x           = data(980:1003,3); % sgsdrt.us - Ambient
% x           = data(1004:1027,3); % sgsdrt.us - Drought
% x           = data(1028:1045,3); % skotsvar.no - Ambient
% x           = data(1046:1063,3); % skotsvar.no - Drought
% x           = data(1064:1081,3); % ukulingadrt.za - Ambient
% x           = data(1082:1099,3); % ukulingadrt.za - Drought
% x           = data(1100:1117,3); % wayqe.re - Ambient
% x           = data(1118:1135,3); % wayqe.re - Drought
% x           = data(1136:1159,3);  % Hongyuan - Ambient
% x           = data(1160:1183,3); % Hongyuan - Drought
% x           = data(1184:1237,3);  % Hulunber - Ambient
% x           = data(1238:1291,3); % Hulunber - Drought
% x           = data(1292:1325,3);  % Naqui - Ambient
% x           = data(1326:1361,3); % Naqui - Drought
% x           = data(1362:1397,3);     % Urat - Ambient
% x           = data(1398:1433,3);    % Urat - Drought
% x           = data(1434:1470,3);   % Yanchi - Ambient
% x           = data(1471:1507,3);  % Yanchi - Drought

%%
% Calling model
SR_sim      = manzoni_model(x,p);
% max_f       = max(data(1:18,4)); % Ayora.ES - Ambient - maximum respiration
% max_f       = max(data(19:36,4)); % Ayora.ES - Drought - maximum respiration
% max_f       = max(data(37:66,4)); % baddrt.de - Ambient - maximum respiration
% max_f       = max(data(67:95,4)); % baddrt.de - Drought - maximum respiration
% max_f       = max(data(96:113,4)); % brhill.au - Ambient - maximum respiration
% max_f       = max(data(114:131,4)); % brhill.au - Drought - maximum respiration
% max_f       = max(data(132:149,4)); % brookdale.ca - Ambient - maximum respiration
% max_f       = max(data(150:167,4)); % brookdale.ca - Drought - maximum respiration
% max_f       = max(data(168:197,4)); % cedarsav.us - Ambient - maximum respiration
% max_f       = max(data(198:227,4)); % cedarsav.us - Drought - maximum respiration
% max_f       = max(data(228:245,4)); % cobar.au - Ambient - maximum respiration
% max_f       = max(data(246:263,4)); % cobar.au - Drought - maximum respiration
% max_f       = max(data(264:287,4)); % cowidrt.ca - Ambient - maximum respiration
% max_f       = max(data(288:311,4)); % cowidrt.ca - Drought - maximum respiration
% max_f       = max(data(312:335,4)); % dona.ana - Ambient - maximum respiration
% max_f       = max(data(336:359,4)); % dona.ana - Drought - maximum respiratio
% max_f       = max(data(360:383,4)); % GIG - Ambient - maximum respiration
% max_f       = max(data(384:407,4)); % GIG - Drought - maximum respiration
% max_f       = max(data(408:425,4)); % hoide.de - Ambient - maximum respiration
% max_f       = max(data(426:443,4)); % hoide.de - Drought - maximum respiration
% max_f       = max(data(444:467,4)); % horacg,cr - Ambient - maximum respiration
% max_f       = max(data(468:491,4)); % horacg,cr - Drought - maximum respiration
% max_f       = max(data(492:509,4)); % hyide.de - Ambient - maximum respiration
% max_f       = max(data(510:527,4)); % hyide.de - Drought - maximum respiration
% max_f       = max(data(528:545,4)); % lygra.no - Ambient - maximum respiration
% max_f       = max(data(546:563,4)); % lygra.no - Drought - maximum respiration
% max_f       = max(data(564:581,4)); % nyngan.au - Ambient - maximum respiration
% max_f       = max(data(582:599,4)); % nyngan.au - Drought - maximum respiration
% max_f       = max(data(600:623,4)); % P12 - Ambient - maximum respiration
% max_f       = max(data(624:647,4)); % P12 - Drought - maximum respiration
% max_f       = max(data(648:671,4)); % P13 - Ambient - maximum respiration
% max_f       = max(data(672:695,4)); % P13 - Drought - maximum respiration
% max_f       = max(data(696:719,4)); % passogavia.it - Ambient - maximum respiration
% max_f       = max(data(720:743,4)); % passogavia.it - Drought - maximum respiration
% max_f       = max(data(744:761,4)); % PNE_unburned - Ambient - maximum respiration
% max_f       = max(data(762:779,4)); % PNE_unburned - Drought - maximum respiration
% max_f       = max(data(780:803,4)); % Purdue.us - Ambient - maximum respiration
% max_f       = max(data(804:827,4)); % Purdue.us - Drought - maximum respiration
% max_f       = max(data(828:842,4)); % riomayo.ar - Ambient - maximum respiration
% max_f       = max(data(843:859,4)); % riomayo.ar - Drought - maximum respiration
% max_f       = max(data(860:889,4)); % scruzl.us - Ambient - maximum respiration
% max_f       = max(data(890:919,4)); % scruzl.us - Drought - maximum respiration
% max_f       = max(data(920:949,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(950:979,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(980:1003,4)); % sgsdrt.us - Ambient - maximum respiration
% max_f       = max(data(1004:1027,4)); % sgsdrt.us - Drought - maximum respiration
% max_f       = max(data(1028:1045,4)); % skotsvar.no - Ambient - maximum respiration
% max_f       = max(data(1046:1063,4)); % skotsvar.no - Drought - maximum respiration
% max_f       = max(data(1064:1081,4)); % ukulingadrt.za - Ambient - maximum respiration
% max_f       = max(data(1082:1099,4)); % ukulingadrt.za - Drought - maximum respiration
% max_f       = max(data(1100:1117,4)); % wayqe.re - Ambient - maximum respiration
% max_f       = max(data(1118:1135,4)); % wayqe.re - Drought - maximum respiration
% max_f       = max(data(1136:1159,4));  % Hongyuan - Ambient
% max_f       = max(data(1160:1183,4)); % Hongyuan - Drought
% max_f       = max(data(1184:1237,4));  % Hulunber - Ambient
% max_f           = max(data(1238:1291,4)); % Hulunber - Drought
% max_f           = max(data(1292:1325,4));  % Naqui - Ambient
% max_f           = max(data(1326:1361,4)); % Naqui - Drought
% max_f           = max(data(1362:1397,4));     % Urat - Ambient
% max_f           = max(data(1398:1433,4));    % Urat - Drought
% max_f           = max(data(1434:1470,4));   % Yanchi - Ambient
% max_f           = max(data(1471:1507,4));  % Yanchi - Drought

% Observations
% SR_obs      = data(1:18,4)/max_f; % Ayora.ES - Ambient
% SR_obs      = data(19:36,4)/max_f; % Ayora.ES - Drought
% SR_obs      = data(37:66,4)/max_f; % baddrt.de - Ambient
% SR_obs      = data(67:95,4)/max_f; % baddrt.de - Drought
% SR_obs      = data(96:113,4)/max_f; % brhill.au - Ambient
% SR_obs      = data(114:131,4)/max_f; % brhill.au - Drought
% SR_obs      = data(132:149,4)/max_f; % brookdale.ca - Ambient
% SR_obs      = data(150:167,4)/max_f; % brookdale.ca - Drought
% SR_obs      = data(168:197,4)/max_f; % cedarsav.us - Ambient
% SR_obs      = data(198:227,4)/max_f; % cedarsav.us - Drought
% SR_obs      = data(228:245,4)/max_f; % cobar.au - Ambient
% SR_obs      = data(246:263,4)/max_f; % cobar.au - Drought
% SR_obs      = data(264:287,4)/max_f; % cowidrt.ca - Ambient
% SR_obs      = data(288:311,4)/max_f; % cowidrt.ca - Drought
% SR_obs      = data(312:335,4)/max_f; % dona.ana - Ambient
% SR_obs      = data(336:359,4)/max_f; % dona.ana - Drought
% SR_obs      = data(360:383,4)/max_f; % GIG - Ambient
% SR_obs      = data(384:407,4)/max_f; % GIG - Drought
% SR_obs      = data(408:425,4)/max_f; % hoide.de - Ambient
% SR_obs      = data(426:443,4)/max_f; % hoide.de - Drought
% SR_obs      = data(444:467,4)/max_f; % horacg,cr - Ambient
% SR_obs      = data(468:491,4)/max_f; % horacg,cr - Drought
% SR_obs      = data(492:509,4)/max_f; % hyide.de - Ambient
% SR_obs      = data(510:527,4)/max_f; % hyide.de - Drought
% SR_obs      = data(528:545,4)/max_f; % lygra.no - Ambient
% SR_obs      = data(546:563,4)/max_f; % lygra.no - Drought
% SR_obs      = data(564:581,4)/max_f; % nyngan.au - Ambient
% SR_obs      = data(582:599,4)/max_f; % nyngan.au - Drought
% SR_obs      = data(600:623,4)/max_f; % P12 - Ambient
% SR_obs      = data(624:647,4)/max_f; % P12 - Drought
% SR_obs      = data(648:671,4)/max_f; % P13 - Ambient
% SR_obs      = data(672:695,4)/max_f; % P13 - Drought
% SR_obs      = data(696:719,4)/max_f; % passogavia.it - Ambient
% SR_obs      = data(720:743,4)/max_f; % passogavia.it - Drought
% SR_obs      = data(744:761,4)/max_f; % PNE_unburned - Ambient
% SR_obs      = data(762:779,4)/max_f; % PNE_unburned - Drought
% SR_obs      = data(780:803,4)/max_f; % Purdue.us - Ambient
% SR_obs      = data(804:827,4)/max_f; % Purdue.us - Drought
% SR_obs      = data(828:842,4)/max_f; % riomayo.ar - Ambient
% SR_obs      = data(843:859,4)/max_f; % riomayo.ar - Drought
% SR_obs      = data(860:889,4)/max_f; % scruzl.us - Ambient
% SR_obs      = data(890:919,4)/max_f; % scruzl.us - Drought
% SR_obs      = data(920:949,4)/max_f; % Sev.mix - Ambient
% SR_obs      = data(950:979,4)/max_f; % Sev.mix - Drought
% SR_obs      = data(980:1003,4)/max_f; % sgsdrt.us - Ambient
% SR_obs      = data(1004:1027,4)/max_f; % sgsdrt.us - Drought
% SR_obs      = data(1028:1045,4)/max_f; % skotsvar.no - Ambient
% SR_obs      = data(1046:1063,4)/max_f; % skotsvar.no - Drought
% SR_obs      = data(1064:1081,4)/max_f; % ukulingadrt.za - Ambient
% SR_obs      = data(1082:1099,4)/max_f; % ukulingadrt.za - Drought
% SR_obs      = data(1100:1117,4)/max_f; % wayqe.re - Ambient
% SR_obs      = data(1118:1135,4)/max_f; % wayqe.re - Drought
% SR_obs        = data(1136:1159,4)/max_f;  % Hongyuan - Ambient
% SR_obs           = data(1160:1183,4)/max_f; % Hongyuan - Drought
% SR_obs           = data(1184:1237,4)/max_f;  % Hulunber - Ambient
% SR_obs           = data(1238:1291,4)/max_f; % Hulunber - Drought
% SR_obs           = data(1292:1325,4)/max_f;  % Naqui - Ambient
% SR_obs           = data(1326:1361,4)/max_f; % Naqui - Drought
% SR_obs           = data(1362:1397,4)/max_f;     % Urat - Ambient
% SR_obs           = data(1398:1433,4)/max_f;    % Urat - Drought
% SR_obs           = data(1434:1470,4)/max_f;   % Yanchi - Ambient
SR_obs           = data(1471:1507,4)/max_f;  % Yanchi - Drought

% Standard deviations
% SR_sd      = data(1:18,5)/max_f; % Ayora.ES - Ambient
% SR_sd      = data(19:36,5)/max_f; % Ayora.ES - Drought
% SR_sd      = data(37:66,5)/max_f; % baddrt.de - Ambient
% SR_sd      = data(67:95,5)/max_f; % baddrt.de - Drought
% SR_sd      = data(96:113,5)/max_f; % brhill.au - Ambient
% SR_sd      = data(114:131,5)/max_f; % brhill.au - Drought
% SR_sd      = data(132:149,5)/max_f; % brookdale.ca - Ambient
% SR_sd      = data(150:167,5)/max_f; % brookdale.ca - Drought
% SR_sd      = data(168:197,5)/max_f; % cedarsav.us - Ambient
% SR_sd      = data(198:227,5)/max_f; % cedarsav.us - Drought
% SR_sd      = data(228:245,5)/max_f; % cobar.au - Ambient
% SR_sd      = data(246:263,5)/max_f; % cobar.au - Drought
% SR_sd      = data(264:287,5)/max_f; % cowidrt.ca - Ambient
% SR_sd      = data(288:311,5)/max_f; % cowidrt.ca - Drought
% SR_sd      = data(312:335,5)/max_f; % dona.ana - Ambient
% SR_sd      = data(336:359,5)/max_f; % dona.ana - Drought
% SR_sd      = data(360:383,5)/max_f; % GIG - Ambient
% SR_sd      = data(384:407,5)/max_f; % GIG - Drought
% SR_sd      = data(408:425,5)/max_f; % hoide.de - Ambient
% SR_sd      = data(426:443,5)/max_f; % hoide.de - Drought
% SR_sd      = data(444:467,5)/max_f; % horacg,cr - Ambient
% SR_sd      = data(468:491,5)/max_f; % horacg,cr - Drought
% SR_sd      = data(492:509,5)/max_f; % hyide.de - Ambient
% SR_sd      = data(510:527,5)/max_f; % hyide.de - Drought
% SR_sd      = data(528:545,5)/max_f; % lygra.no - Ambient
% SR_sd      = data(546:563,5)/max_f; % lygra.no - Drought
% SR_sd      = data(564:581,5)/max_f; % nyngan.au - Ambient
% SR_sd      = data(582:599,5)/max_f; % nyngan.au - Drought
% SR_sd      = data(600:623,5)/max_f; % P12 - Ambient
% SR_sd      = data(624:647,5)/max_f; % P12 - Drought
% SR_sd      = data(648:671,5)/max_f; % P13 - Ambient
% SR_sd      = data(672:695,5)/max_f; % P13 - Drought
% SR_sd      = data(696:719,5)/max_f; % passogavia.it - Ambient
% SR_sd      = data(720:743,5)/max_f; % passogavia.it - Drought
% SR_sd      = data(744:761,5)/max_f; % PNE_unburned - Ambient
% SR_sd      = data(762:779,5)/max_f; % PNE_unburned - Drought
% SR_sd      = data(780:803,5)/max_f; % Purdue.us - Ambient
% SR_sd      = data(804:827,5)/max_f; % Purdue.us - Drought
% SR_sd      = data(828:842,5)/max_f; % riomayo.ar - Ambient
% SR_sd      = data(843:859,5)/max_f; % riomayo.ar - Drought
% SR_sd      = data(860:889,5)/max_f; % scruzl.us - Ambient
% SR_sd      = data(890:919,5)/max_f; % scruzl.us - Drought
% SR_sd      = data(920:949,5)/max_f; % Sev.mix - Ambient
% SR_sd      = data(950:979,5)/max_f; % Sev.mix - Drought
% SR_sd      = data(980:1003,5)/max_f; % sgsdrt.us - Ambient
% SR_sd      = data(1004:1027,5)/max_f; % sgsdrt.us - Drought
% SR_sd      = data(1028:1045,5)/max_f; % skotsvar.no - Ambient
% SR_sd      = data(1046:1063,5)/max_f; % skotsvar.no - Drought
% SR_sd      = data(1064:1081,5)/max_f; % ukulingadrt.za - Ambient
% SR_sd      = data(1082:1099,5)/max_f; % ukulingadrt.za - Drought
% SR_sd      = data(1100:1117,5)/max_f; % wayqe.re - Ambient
% SR_sd      = data(1118:1135,5)/max_f; % wayqe.re - Drought
% SR_sd        = data(1136:1159,5)/max_f;  % Hongyuan - Ambient
% SR_sd           = data(1160:1183,5)/max_f; % Hongyuan - Drought
% SR_sd           = data(1184:1237,5)/max_f;  % Hulunber - Ambient
% SR_sd           = data(1238:1291,5)/max_f; % Hulunber - Drought
% SR_sd           = data(1292:1325,5)/max_f;  % Naqui - Ambient
% SR_sd           = data(1326:1361,5)/max_f; % Naqui - Drought
% SR_sd           = data(1362:1397,5)/max_f;     % Urat - Ambient
% SR_sd           = data(1398:1433,5)/max_f;    % Urat - Drought
% SR_sd           = data(1434:1470,5)/max_f;   % Yanchi - Ambient
SR_sd           = data(1471:1507,5)/max_f;  % Yanchi - Drought


% Objective function - residual sum of squares
SSE_1       = sum(((log(SR_obs) - log(SR_sim)).^2)./(log(SR_sd)).^2);
% SSE         = SSE_1^0.5
SSE         = SSE_1

% fig = figure;
plot(log10(x),SR_sim,"*");
hold on
plot(log10(x),SR_obs,"o");
xline(log10(p(3)),'-r');
xline(p(1),'-b');

% fig = figure;
% scatter(SR_obs,SR_sim)
end