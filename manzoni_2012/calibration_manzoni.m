function [SSE] = calibration_manzoni(p)

% Calling data
% 
% data        = load("data_manzoni_matlab.txt");
data        = load("china_matlab.txt");
% data(1110:1127,:);
%% Soil Water Potential

% x           = data(1:18,3); % Ayora.ES - Ambient
% x           = data(19:36,3); % Ayora.ES - Drought
% x           = data(37:60,3); % GIG - Ambient
% x           = data(61:84,3); % GIG - Drought
% x           = data(85:108,3); % P12 - Ambient
% x           = data(109:132,3); % P12 - Drought
% x           = data(133:156,3); % P13 - Ambient
% x           = data(157:180,3); % P13 - Drought
% x           = data(181:198,3); % PNE_unburned - Ambient
% x           = data(199:216,3); % PNE_unburned - Drought
% x           = data(217:240,3); % Purdue.us - Ambient
% x           = data(241:264,3); % Purdue.us - Drought
% x           = data(265:294,3); % Sev.mix - Ambient
% x           = data(295:324,3); % Sev.mix - Drought
% x           = data(325:354,3); % baddrt.de - Ambient
% x           = data(355:383,3); % baddrt.de - Drought
% x           = data(384:401,3); % brhill.au - Ambient
% x           = data(402:419,3); % brhill.au - Drought
% x           = data(420:437,3); % brookdale.ca - Ambient
% x           = data(438:455,3); % brookdale.ca - Drought
% x           = data(456:484,3); % cedarsav.us - Ambient
% x           = data(485:512,3); % cedarsav.us - Drought
% x           = data(513:529,3); % cobar.au - Ambient
% x           = data(530:546,3); % cobar.au - Drought
% x           = data(547:570,3); % cowidrt.ca - Ambient
% x           = data(571:594,3); % cowidrt.ca - Drought
% x           = data(595:617,3); % dona.ana - Ambient
% x           = data(618:641,3); % dona.ana - Drought
% x           = data(642:659,3); % hoide.de - Ambient
% x           = data(660:677,3); % hoide.de - Drought
% x           = data(678:701,3); % horacg,cr - Ambient
% x           = data(702:725,3); % horacg,cr - Drought
% x           = data(726:742,3); % hyide.de - Ambient
% x           = data(743:760,3); % hyide.de - Drought
% x           = data(761:778,3); % lygra.no - Ambient
% x           = data(779:796,3); % lygra.no - Drought
% x           = data(797:814,3); % nyngan.au - Ambient
% x           = data(815:832,3); % nyngan.au - Drought
% x           = data(833:856,3); % passogavia.it - Ambient
% x           = data(857:880,3); % passogavia.it - Drought
% x           = data(881:895,3); % riomayo.ar - Ambient
% x           = data(896:912,3); % riomayo.ar - Drought
% x           = data(913:942,3); % scruzl.us - Ambient
% x           = data(943:972,3); % scruzl.us - Drought
% x           = data(973:995,3); % sgsdrt.us - Ambient
% x           = data(996:1019,3); % sgsdrt.us - Drought
% x           = data(1020:1037,3); % skotsvar.no - Ambient
% x           = data(1038:1055,3); % skotsvar.no - Drought
% x           = data(1056:1073,3); % ukulingadrt.za - Ambient
% x           = data(1074:1091,3); % ukulingadrt.za - Drought
% x           = data(1092:1109,3); % wayqe.re - Ambient
% x           = data(1110:1127,3); % wayqe.re - Drought
% x           = data(1:36,3);     % Urat - Ambient
% x           = data(37:72,3);    % Urat - Drought
% x           = data(73:108,3);   % Yanchi - Ambient
% x           = data(109:144,3);  % Yanchi - Drought
% x           = data(145:167,3);  % Hongyuan - Ambient
% x           = data(168:191,3); % Hongyuan - Drought
% x           = data(192:226,3);  % Hulunber - Ambient
% x           = data(227:262,3); % Hulunber - Drought
x           = data(263:296,3);  % Naqui - Ambient
% x           = data(297:331,3); % Naqui - Drought

%%
% Calling model
SR_sim      = manzoni_model(x,p);
% max_f       = max(data(1:18,4)); % Ayora.ES - Ambient - maximum respiration
% max_f       = max(data(19:36,4)); % Ayora.ES - Drought - maximum respiration
% max_f       = max(data(37:60,4)); % GIG - Ambient - maximum respiration
% max_f       = max(data(61:84,4)); % GIG - Drought - maximum respiration
% max_f       = max(data(85:108,4)); % P12 - Ambient - maximum respiration
% max_f       = max(data(109:132,4)); % P12 - Drought - maximum respiration
% max_f       = max(data(133:156,4)); % P13 - Ambient - maximum respiration
% max_f       = max(data(157:180,4)); % P13 - Drought - maximum respiration
% max_f       = max(data(181:198,4)); % PNE_unburned - Ambient - maximum respiration
% max_f       = max(data(199:216,4)); % PNE_unburned - Drought - maximum respiration
% max_f       = max(data(217:240,4)); % Purdue.us - Ambient - maximum respiration
% max_f       = max(data(241:264,4)); % Purdue.us - Drought - maximum respiration
% max_f       = max(data(265:294,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(295:324,4)); % Sev.mix - Drought - maximum respiration
% max_f       = max(data(325:354,4)); % baddrt.de - Ambient - maximum respiration
% max_f       = max(data(355:383,4)); % baddrt.de - Drought - maximum respiration
% max_f       = max(data(384:401,4)); % brhill.au - Ambient - maximum respiration
% max_f       = max(data(402:419,4)); % brhill.au - Drought - maximum respiration
% max_f       = max(data(420:437,4)); % brookdale.ca - Ambient - maximum respiration
% max_f       = max(data(438:455,4)); % brookdale.ca - Drought - maximum respiration
% max_f       = max(data(456:484,4)); % cedarsav.us - Ambient - maximum respiration
% max_f       = max(data(485:512,4)); % cedarsav.us - Drought - maximum respiration
% max_f       = max(data(513:529,4)); % cobar.au - Ambient - maximum respiration
% max_f       = max(data(530:546,4)); % cobar.au - Drought - maximum respiration
% max_f       = max(data(547:570,4)); % cowidrt.ca - Ambient - maximum respiration
% max_f       = max(data(571:594,4)); % cowidrt.ca - Drought - maximum respiration
% max_f       = max(data(595:617,4)); % dona.ana - Ambient - maximum respiration
% max_f       = max(data(618:641,4)); % dona.ana - Drought - maximum respiration
% max_f       = max(data(642:659,4)); % hoide.de - Ambient - maximum respiration
% max_f       = max(data(660:677,4)); % hoide.de - Drought - maximum respiration
% max_f       = max(data(678:701,4)); % horacg,cr - Ambient - maximum respiration
% max_f       = max(data(702:725,4)); % horacg,cr - Drought - maximum respiration
% max_f       = max(data(726:742,4)); % hyide.de - Ambient - maximum respiration
% max_f       = max(data(743:760,4)); % hyide.de - Drought - maximum respiration
% max_f       = max(data(761:778,4)); % lygra.no - Ambient - maximum respiration
% max_f       = max(data(779:796,4)); % lygra.no - Drought - maximum respiration
% max_f       = max(data(797:814,4)); % nyngan.au - Ambient - maximum respiration
% max_f       = max(data(815:832,4)); % nyngan.au - Drought - maximum respiration
% max_f       = max(data(833:856,4)); % passogavia.it - Ambient - maximum respiration
% max_f       = max(data(857:880,4)); % passogavia.it - Drought - maximum respiration
% max_f       = max(data(881:895,4)); % riomayo.ar - Ambient - maximum respiration
% max_f       = max(data(896:912,4)); % riomayo.ar - Drought - maximum respiration
% max_f       = max(data(913:942,4)); % scruzl.us - Ambient - maximum respiration
% max_f       = max(data(943:972,4)); % scruzl.us - Drought - maximum respiration
% max_f       = max(data(973:995,4)); % sgsdrt.us - Ambient - maximum respiration
% max_f       = max(data(996:1019,4)); % sgsdrt.us - Drought - maximum respiration
% max_f       = max(data(1020:1037,4)); % skotsvar.no - Ambient - maximum respiration
% max_f       = max(data(1038:1055,4)); % skotsvar.no - Drought - maximum respiration
% max_f       = max(data(1056:1073,4)); % ukulingadrt.za - Ambient - maximum respiration
% max_f       = max(data(1074:1091,4)); % ukulingadrt.za - Drought - maximum respiration
% max_f       = max(data(1092:1109,4)); % wayqe.re - Ambient - maximum respiration
% max_f       = max(data(1110:1127,4)); % wayqe.re - Drought - maximum respiration
% max_f           = max(data(1:36,4));     % Urat - Ambient
% max_f           = max(data(37:72,4));    % Urat - Drought
% max_f           = max(data(73:108,4));   % Yanchi - Ambient
% max_f           = max(data(109:144,4));  % Yanchi - Drought
% max_f           = max(data(145:167,4));  % Hongyuan - Ambient
% max_f           = max(data(168:191,4)); % Hongyuan - Drought
% max_f           = max(data(192:226,4));  % Hulunber - Ambient
% max_f           = max(data(227:262,4)); % Hulunber - Drought
max_f           = max(data(263:296,4));  % Naqui - Ambient
% max_f           = max(data(297:331,4)); % Naqui - Drought

% Observations
% SR_obs      = data(1:18,4)/max_f; % Ayora.ES - Ambient
% SR_obs      = data(19:36,4)/max_f; % Ayora.ES - Drought
% SR_obs      = data(37:60,4)/max_f; % GIG - Ambient
% SR_obs      = data(61:84,4)/max_f; % GIG - Drought
% SR_obs      = data(85:108,4)/max_f; % P12 - Ambient
% SR_obs      = data(109:132,4)/max_f; % P12 - Drought
% SR_obs      = data(133:156,4)/max_f; % P13 - Ambient
% SR_obs      = data(157:180,4)/max_f; % P13 - Drought
% SR_obs      = data(181:198,4)/max_f; % PNE_unburned - Ambient
% SR_obs      = data(199:216,4)/max_f; % PNE_unburned - Drought
% SR_obs      = data(217:240,4)/max_f; % Purdue.us - Ambient
% SR_obs      = data(241:264,4)/max_f; % Purdue.us - Drought
% SR_obs      = data(265:294,4)/max_f; % Sev.mix - Ambient
% SR_obs      = data(295:324,4)/max_f; % Sev.mix - Drought
% SR_obs      = data(325:354,4)/max_f; % baddrt.de - Ambient
% SR_obs      = data(355:383,4)/max_f; % baddrt.de - Drought
% SR_obs      = data(384:401,4)/max_f; % brhill.au - Ambient
% SR_obs      = data(402:419,4)/max_f; % brhill.au - Drought
% SR_obs      = data(420:437,4)/max_f; % brookdale.ca - Ambient
% SR_obs      = data(438:455,4)/max_f; % brookdale.ca - Drought
% SR_obs      = data(456:484,4)/max_f; % cedarsav.us - Ambient
% SR_obs      = data(485:512,4)/max_f; % cedarsav.us - Drought
% SR_obs      = data(513:529,4)/max_f; % cobar.au - Ambient
% SR_obs      = data(530:546,4)/max_f; % cobar.au - Drought
% SR_obs      = data(547:570,4)/max_f; % cowidrt.ca - Ambient
% SR_obs      = data(571:594,4)/max_f; % cowidrt.ca - Drought
% SR_obs      = data(595:617,4)/max_f; % dona.ana - Ambient
% SR_obs      = data(618:641,4)/max_f; % dona.ana - Drought
% SR_obs      = data(642:659,4)/max_f; % hoide.de - Ambient
% SR_obs      = data(660:677,4)/max_f; % hoide.de - Drought
% SR_obs      = data(678:701,4)/max_f; % horacg,cr - Ambient
% SR_obs      = data(702:725,4)/max_f; % horacg,cr - Drought
% SR_obs      = data(726:742,4)/max_f; % hyide.de - Ambient
% SR_obs      = data(743:760,4)/max_f; % hyide.de - Drought
% SR_obs      = data(761:778,4)/max_f; % lygra.no - Ambient
% SR_obs      = data(779:796,4)/max_f; % lygra.no - Drought
% SR_obs      = data(797:814,4)/max_f; % nyngan.au - Ambient
% SR_obs      = data(815:832,4)/max_f; % nyngan.au - Drought
% SR_obs      = data(833:856,4)/max_f; % passogavia.it - Ambient
% SR_obs      = data(857:880,4)/max_f; % passogavia.it - Drought
% SR_obs      = data(881:895,4)/max_f; % riomayo.ar - Ambient
% SR_obs      = data(896:912,4)/max_f; % riomayo.ar - Drought
% SR_obs      = data(913:942,4)/max_f; % scruzl.us - Ambient
% SR_obs      = data(943:972,4)/max_f; % scruzl.us - Drought
% SR_obs      = data(973:995,4)/max_f; % sgsdrt.us - Ambient
% SR_obs      = data(996:1019,4)/max_f; % sgsdrt.us - Drought
% SR_obs      = data(1020:1037,4)/max_f; % skotsvar.no - Ambient
% SR_obs      = data(1038:1055,4)/max_f; % skotsvar.no - Drought
% SR_obs      = data(1056:1073,4)/max_f; % ukulingadrt.za - Ambient
% SR_obs      = data(1074:1091,4)/max_f; % ukulingadrt.za - Drought
% SR_obs      = data(1092:1109,4)/max_f; % wayqe.re - Ambient
% SR_obs      = data(1110:1127,4)/max_f; % wayqe.re - Drought
% SR_obs           = data(1:36,4)/max_f;     % Urat - Ambient
% SR_obs           = data(37:72,4)/max_f;    % Urat - Drought
% SR_obs           = data(73:108,4)/max_f;   % Yanchi - Ambient
% SR_obs           = data(109:144,4)/max_f;  % Yanchi - Drought
% SR_obs           = data(145:167,4)/max_f;  % Hongyuan - Ambient
% SR_obs           = data(168:191,4)/max_f; % Hongyuan - Drought
% SR_obs           = data(192:226,4)/max_f;  % Hulunber - Ambient
% SR_obs           = data(227:262,4)/max_f; % Hulunber - Drought
SR_obs           = data(263:296,4)/max_f;  % Naqui - Ambient
% SR_obs           = data(297:331,4)/max_f; % Naqui - Drought

% Standard deviations
% SR_sd      = data(1:18,5)/max_f; % Ayora.ES - Ambient
% SR_sd      = data(19:36,5)/max_f; % Ayora.ES - Drought
% SR_sd      = data(37:60,5)/max_f; % GIG - Ambient
% SR_sd      = data(61:84,5)/max_f; % GIG - Drought
% SR_sd      = data(85:108,5)/max_f; % P12 - Ambient
% SR_sd      = data(109:132,5)/max_f; % P12 - Drought
% SR_sd      = data(133:156,5)/max_f; % P13 - Ambient
% SR_sd      = data(157:180,5)/max_f; % P13 - Drought
% SR_sd      = data(181:198,5)/max_f; % PNE_unburned - Ambient
% SR_sd      = data(199:216,5)/max_f; % PNE_unburned - Drought
% SR_sd      = data(217:240,5)/max_f; % Purdue.us - Ambient
% SR_sd      = data(241:264,5)/max_f; % Purdue.us - Drought
% SR_sd      = data(265:294,5)/max_f; % Sev.mix - Ambient
% SR_sd      = data(295:324,5)/max_f; % Sev.mix - Drought
% SR_sd      = data(325:354,5)/max_f; % baddrt.de - Ambient
% SR_sd      = data(355:383,5)/max_f; % baddrt.de - Drought
% SR_sd      = data(384:401,5)/max_f; % brhill.au - Ambient
% SR_sd      = data(402:419,5)/max_f; % brhill.au - Drought
% SR_sd      = data(420:437,5)/max_f; % brookdale.ca - Ambient
% SR_sd      = data(438:455,5)/max_f; % brookdale.ca - Drought
% SR_sd      = data(456:484,5)/max_f; % cedarsav.us - Ambient
% SR_sd      = data(485:512,5)/max_f; % cedarsav.us - Drought
% SR_sd      = data(513:529,5)/max_f; % cobar.au - Ambient
% SR_sd      = data(530:546,5)/max_f; % cobar.au - Drought
% SR_sd      = data(547:570,5)/max_f; % cowidrt.ca - Ambient
% SR_sd      = data(571:594,5)/max_f; % cowidrt.ca - Drought
% SR_sd      = data(595:617,5)/max_f; % dona.ana - Ambient
% SR_sd      = data(618:641,5)/max_f; % dona.ana - Drought
% SR_sd      = data(642:659,5)/max_f; % hoide.de - Ambient
% SR_sd      = data(660:677,5)/max_f; % hoide.de - Drought
% SR_sd      = data(678:701,5)/max_f; % horacg,cr - Ambient
% SR_sd      = data(702:725,5)/max_f; % horacg,cr - Drought
% SR_sd      = data(726:742,5)/max_f; % hyide.de - Ambient
% SR_sd      = data(743:760,5)/max_f; % hyide.de - Drought
% SR_sd      = data(761:778,5)/max_f; % lygra.no - Ambient
% SR_sd      = data(779:796,5)/max_f; % lygra.no - Drought
% SR_sd      = data(797:814,5)/max_f; % nyngan.au - Ambient
% SR_sd      = data(815:832,5)/max_f; % nyngan.au - Drought
% SR_sd      = data(833:856,5)/max_f; % passogavia.it - Ambient
% SR_sd      = data(857:880,5)/max_f; % passogavia.it - Drought
% SR_sd      = data(881:895,5)/max_f; % riomayo.ar - Ambient
% SR_sd      = data(896:912,5)/max_f; % riomayo.ar - Drought
% SR_sd      = data(913:942,5)/max_f; % scruzl.us - Ambient
% SR_sd      = data(943:972,5)/max_f; % scruzl.us - Drought
% SR_sd      = data(973:995,5)/max_f; % sgsdrt.us - Ambient
% SR_sd      = data(996:1019,5)/max_f; % sgsdrt.us - Drought
% SR_sd      = data(1020:1037,5)/max_f; % skotsvar.no - Ambient
% SR_sd      = data(1038:1055,5)/max_f; % skotsvar.no - Drought
% SR_sd      = data(1056:1073,5)/max_f; % ukulingadrt.za - Ambient
% SR_sd      = data(1074:1091,5)/max_f; % ukulingadrt.za - Drought
% SR_sd      = data(1092:1109,5)/max_f; % wayqe.re - Ambient
% SR_sd      = data(1110:1127,5)/max_f; % wayqe.re - Drought
% SR_sd           = data(1:36,5)/max_f;     % Urat - Ambient
% SR_sd           = data(37:72,5)/max_f;    % Urat - Drought
% SR_sd           = data(73:108,5)/max_f;   % Yanchi - Ambient
% SR_sd           = data(109:144,5)/max_f;  % Yanchi - Drought
% SR_sd           = data(145:167,5)/max_f;  % Hongyuan - Ambient
% SR_sd           = data(168:191,5)/max_f; % Hongyuan - Drought
% SR_sd           = data(192:226,5)/max_f;  % Hulunber - Ambient
% SR_sd           = data(227:262,5)/max_f; % Hulunber - Drought
SR_sd           = data(263:296,5)/max_f;  % Naqui - Ambient
% SR_sd           = data(297:331,5)/max_f; % Naqui - Drought

% Objective function - residual sum of squares
SSE_1       = sum(((log(SR_obs) - log(SR_sim)).^2)./(log(SR_sd)).^2);
% SSE         = SSE_1^0.5
SSE         = SSE_1

% fig = figure;
plot(log10(x),SR_sim,"*");
hold on
plot(log10(x),SR_obs,"o");
xline(log10(p(3)),'-r');
xline(p(1),'-b');

% fig = figure;
% scatter(SR_obs,SR_sim)
end